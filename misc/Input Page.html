
<!DOCTYPE html>
<html>
<head>
  <title>Importing</title>
  <link rel="stylesheet" href="../css/style.css">
  <script src="https://unpkg.com/d3@5.6.0/dist/d3.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.13.5/xlsx.full.min.js"></script>


</head>
<body>

  <nav>
    <div class="logo">
      <h4><a href="../gui/Homepage.html">STRATAVIS</h4>
    </div>
      <ul class="nav-links">
        <li>
          <a href="../gui/Homepage.html">Home</a>
        </li>
        <li>
          <a href="../gui/About.html">About</a>
        </li>
        <li>
          <a href="../gui/Dashboard.html">Dashboard</a>
        </li>
        <li>
          <a href="../gui/Contact.html">Contact Us</a>
        </li>
      </ul>

    <div class="burger">
      <div class="line1"></div>
      <div class="line2"></div>
      <div class="line3"></div>
    </div>
  </nav>

  <div id="wrapper">

  <div id="particles-js">
    <script src="../js/particles.js"></script>
    <script src="../js/app.js"></script>
  </div>

    <section class="banner">
      <div class="imgBx">
        <img src="../image/img1.jpg" class="active">
        <img src="../image/img2.jpg">
        <img src="../image/img3.jpg">
        <img src="../image/img4.jpg">
      </div>

      <div class="contentBx">
        <div class="active">
          <h2>Visualise Your Data Your Own Way</h2>
          <p>dwdwdwdwdwdwdwdwdwd</p>
          <a href="#">Details</a>
        </div>
        <div>
          <h2>Slide Text Two</h2>
          <p>dwdwdwdwdwdwdwdwdwd</p>
          <a href="#">Details</a>
        </div>
        <div class="input_form">
          <form  method="POST">

            <h1>Please insert your data</h1>

            <label id="fname">First Name</label>
            <input type="text" placeholder="John" name="name" required><br/><br/>

            <label id="lname">Last Name</label>
            <input type="text" placeholder="Doe" name="name" required><br/><br/>

            <label id="email">Email</label>
            <input type="text" placeholder="Enter email" name="email" required><br/><br/>

            <label id="phone">Phone No.</label>
            <input type="text" placeholder="Enter phone" name="phone" required><br/><br/>


            <input type="file"  id="upload_file" accept=".xls,.xlsx,.csv"/>

            <label id="display"></label><br/><br/>
            <script>

              let data;
              let yColumn;
              let cell = [];

              let selectedFile;

              const onYColumnClicked = column =>{
                yColumn = column;
                render();
              };

              const render = () => {
                d3.select(#char)
                let select = selection.selectAll('select').data([null]);
                select = select.enter()
                  .append('select')
                  .merge(select)
                  .on('change',function() {
                    onOptionClicked(this.value);
                  });

                const option = select.selectAll('option').data(options);
                option.enter().append('option').merge(option)
                  .attr('value',d => d)
                  .property('selected',d => d === selectedOption)
                  .text(d => d);


              }

              /**

               Parsing Excel File

               **/
              let upload = document.getElementById('upload_file');
              upload.addEventListener("change",(event)=>{

                let fileReader = new FileReader();
                fileReader.readAsBinaryString(event.target.files[0]);
                fileReader.onload = (event) => {
                  let data = event.target.result;
                  let wb = XLSX.read(data,{type:"binary"});
                  var result= {};
                  wb.SheetNames.forEach(function(name){

                    var sheet = wb.Sheets[name],
                      range = XLSX.utils.decode_range(sheet['!ref']),
                      row_start = range.s.r, row_end = range.e.r,
                      col_start = range.s.c, col_end = range.e.c,
                      rows = [], row_data, i, addr, cell;

                    for(row_start=0;row_start<=row_end;row_start++) {
                      row_data = [];
                      for(i=col_start;i<=col_end;i++) {
                        addr = XLSX.utils.encode_col(i) + XLSX.utils.encode_row(row_start);
                        cell = sheet[addr];

                        if(cell.l) {
                          row_data.push({text: cell.v, link: cell.l.Target});
                        } else {
                          row_data.push(cell.v);
                        }
                      }
                      rows.push(row_data);
                    }
                    result[name] = rows;
                  });
                  render(result);


                }

              });

            </script>
            <label id="char" >Please choose 1 characteristic to be grouped by</label>

            <div id="columns"></div><br/><br/>

            <div class="clearfix">
              <a href="../gui/Homepage.html"></a>
                <span><button type="button" class="cancelbtn">Cancel</button></span>
                <span><button type="submit" class="signupbtn">Sample</button></span>
            </div>

          </form>
        </div>
        <div>
          <h2>Slide Text Four</h2>
          <p>dwdwdwdwdwdwdwdwdwd</p>
          <a href="#">Details</a>
        </div>
      </div>

      <ul class="controls">
        <li onclick="prevSlide();prevSlideText();"></li>
        <li onclick="nextSlide();nextSlideText();"></li>
      </ul>
    </section>

    <script type="text/javascript">
      const imgBx = document.querySelector('.imgBx');
      const slides = imgBx.getElementsByTagName('img');
      var i = 0;

      function nextSlide() {
        slides[i].classList.remove('active');
        i= (i + 1) % slides.length;
        slides[i].classList.add('active');

      }

      function prevSlide() {
        slides[i].classList.remove('active');
        i= (i - 1 + slides.length) % slides.length;
        slides[i].classList.add('active');

      }

      const contentBx = document.querySelector('.contentBx');
      const slidesText = contentBx.getElementsByTagName('div');
      var j = 0;

      function nextSlideText() {
        slidesText[j].classList.remove('active');
        j= (j + 1) % slidesText.length;
        slidesText[j].classList.add('active');

      }
      function prevSlideText() {
        slidesText[j].classList.remove('active');
        j = (j - 1 + slidesText.length) % slidesText.length;
        slidesText[j].classList.add('active');
      }
    </script>


    <script src="../js/navigationMenu.js"></script>

  </div>
</body>

</html>
